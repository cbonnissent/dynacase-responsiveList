define("rsp/models/document",["underscore","backbone"],function(){return Backbone.Model.extend({idAttribute:"initid",defaults:{state:null,viewId:"!defaultConsultation",title:"Chargement...",icon:!1,dateSelected:0},initialize:function(){this.set("dateSelected",Date.now())},isNew:function(){return!0},parse:function(t){var e=t.properties;return e.attributes=t.attributes,e}})}),define("rsp/collections/document",["underscore","rsp/models/document","backbone"],function(t,e){var i=t.template("<%= urlBase %>?slice=<%= slice %>&offset=<%= offset %>&keyword=<%= keyWord %>&fields=document.properties.all,document.attributes");return Backbone.Collection.extend({model:e,url:function(){return i(this)},initialize:function(t,e){if(!e.url)throw new Error("the document model needs an url conf");this.urlBase=e.url,this.slice=10,this.offset=0,this.keyWord=""},parse:function(t){return this.nbResult=t.data.resultMax,t.data.documents},reset:function(){return this.nbResult=null,this.slice=10,this.offset=0,Backbone.Collection.prototype.reset.apply(this,arguments)}})}),define("rsp/models/search",["underscore","rsp/collections/document","backbone"],function(t,e){return Backbone.Model.extend({idAttribute:"initid",initialize:function(){this.listenTo(this,"selected",this.prepareDocumentList),this.set("associatedDocumentList",new e([],{url:window.location.pathname+"api/v1/rspl/listDocument/"+this.id})),this.collectionInitialized=!1,this.listenTo(this.get("associatedDocumentList"),"add",this.propagateAdd),this.listenTo(this.get("associatedDocumentList"),"reset",this.propagateReset),this.listenTo(this.get("associatedDocumentList"),"sync",this.propagateSync)},parse:function(t){return t.properties},prepareDocumentList:function(){this.collectionInitialized||this.get("associatedDocumentList").fetch()},propagateAdd:function(t){this.trigger("addDocumentList",this,this.get("associatedDocumentList"),t)},propagateReset:function(){this.trigger("resetDocumentList",this,this.get("associatedDocumentList"))},propagateSync:function(){this.trigger("syncDocumentList",this,this.get("associatedDocumentList"))}})}),define("rsp/collections/search",["underscore","rsp/models/search","backbone"],function(t,e){return Backbone.Collection.extend({url:window.location.pathname+"api/v1/rspl/listDocument/DIR_RESPONSIVE_LIST",model:e,parse:function(t){return t.data.documents}})}),define("rsp/collections/openDocument",["underscore","rsp/models/document","backbone"],function(t,e){return Backbone.Collection.extend({model:e,comparator:"dataSelected",initialize:function(){this.listenTo(this,"selected",this.propagateSelected),this.listenTo(this,"selectPrevious",this.selectPrevious),this.listenTo(this,"selectNext",this.selectNext),this.listenTo(this,"destroy",this.selectAnotherOne)},propagateSelected:function(t,e){this.each(function(i){i.set("selected",t.id===i.id),t.id===i.id&&e&&i.set("dateSelected",Date.now())}),this.trigger("orderChanged"),this.sort()},selectPrevious:function(e){var i=this.sortBy(function(t){return-t.get("dateSelected")});this.propagateSelected(i[t.indexOf(i,e)-1])},selectNext:function(e){var i=this.sortBy(function(t){return-t.get("dateSelected")});this.propagateSelected(i[t.indexOf(i,e)+1])},selectAnotherOne:function(t,e,i){var n=this.at(i.index)||this.at(i.index-1);t.get("selected")&&n&&n.trigger("selected",n),0===this.length&&(window.document.title="Les documents")}})}),define("rsp/views/search",["underscore","backbone"],function(){return Backbone.View.extend({tagName:"option",render:function(){return this.$el.data("searchId",this.model.id).attr("value",this.model.id).addClass("searchElement").text(this.model.get("title")),this}})}),define("rsp/views/searches",["underscore","rsp/views/search","backbone"],function(t,e){var i=t.template('<select class="form-control documentsList__searchList__select"></select>');return Backbone.View.extend({tagName:"form",events:{change:"displayDocumentList"},initialize:function(t){if(!t.collection)throw new Error("You need to associate the searches view with a collection");this.collection=t.collection,this.listenTo(this.collection,"add",this._addOne),this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"sync",this.displayDocumentList)},render:function(){return this.$el.empty().append(i()),this._addAll(),this},_addAll:function(){this.collection.each(this._addOne)},_addOne:function(t){var i=new e({model:t});this.$el.find(".documentsList__searchList__select").append(i.render().$el)},displayDocumentList:function(){var t=this.$el.find(".documentsList__searchList__select").val(),e=this.collection.get(t);e&&e.trigger("selected",e)}})}),define("rsp/views/openDocumentListElement",["underscore","backbone"],function(t){var e=t.template('<a class="documentTab" href="?app=DOCUMENT&id=<%- initid %>" data-id="<%- initid %>" data-title="<%- title %>"><span class="documentTab__text">  <% if (icon) { %><img src="<%- icon %>" class="img-circle documentElement__icon" /> <% } %> <%- title %></span><button type="button" class="close documentTab__remove" aria-label="Close"><span aria-hidden="true">&times;</span></button></a>');return Backbone.View.extend({tagName:"li",className:"openDocuments__tab",events:{click:"selected","click .documentTab__remove":"remove"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"change:selected",this.indicateSelected),this.listenTo(this.model,"destroy",this.delete)},render:function(t){return t=t||{},this.$el.empty().append(e(this.model.toJSON())),this.$el.attr("title",this.model.get("title")),t.hidden&&this.$el.addClass("documentTab__hidden clearfix"),this.indicateSelected(),this},selected:function(t){t.preventDefault(),this.model.trigger("selected",this.model,this.$el.is(".documentTab__hidden"))},indicateSelected:function(){this.model.get("selected")?this.$el.addClass("active"):this.$el.removeClass("active")},remove:function(){this.model.destroy()},"delete":function(){this.$el.remove()}})}),function(t,e,i,n){function s(t,e,i){return setTimeout(u(t,i),e)}function o(t,e,i){return Array.isArray(t)?(r(t,i[e],i),!0):!1}function r(t,e,i){var s;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==n)for(s=0;s<t.length;)e.call(i,t[s],s,t),s++;else for(s in t)t.hasOwnProperty(s)&&e.call(i,t[s],s,t)}function c(t,e,i){for(var s=Object.keys(e),o=0;o<s.length;)(!i||i&&t[s[o]]===n)&&(t[s[o]]=e[s[o]]),o++;return t}function a(t,e){return c(t,e,!0)}function l(t,e,i){var n,s=e.prototype;n=t.prototype=Object.create(s),n.constructor=t,n._super=s,i&&c(n,i)}function u(t,e){return function(){return t.apply(e,arguments)}}function d(t,e){return typeof t==ue?t.apply(e?e[0]||n:n,e):t}function h(t,e){return t===n?e:t}function p(t,e,i){r(g(e),function(e){t.addEventListener(e,i,!1)})}function m(t,e,i){r(g(e),function(e){t.removeEventListener(e,i,!1)})}function f(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function v(t,e){return t.indexOf(e)>-1}function g(t){return t.trim().split(/\s+/g)}function w(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function _(t){return Array.prototype.slice.call(t,0)}function y(t,e,i){for(var n=[],s=[],o=0;o<t.length;){var r=e?t[o][e]:t[o];w(s,r)<0&&n.push(t[o]),s[o]=r,o++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function D(t,e){for(var i,s,o=e[0].toUpperCase()+e.slice(1),r=0;r<ae.length;){if(i=ae[r],s=i?i+o:e,s in t)return s;r++}return n}function T(){return me++}function b(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}function E(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){d(t.options.enable,[t])&&i.handler(e)},this.init()}function S(t){var e,i=t.options.inputClass;return new(e=i?i:ge?F:we?Y:ve?q:P)(t,I)}function I(t,e,i){var n=i.pointers.length,s=i.changedPointers.length,o=e&Ee&&n-s===0,r=e&(Ie|Le)&&n-s===0;i.isFirst=!!o,i.isFinal=!!r,o&&(t.session={}),i.eventType=e,L(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function L(t,e){var i=t.session,n=e.pointers,s=n.length;i.firstInput||(i.firstInput=x(e)),s>1&&!i.firstMultiple?i.firstMultiple=x(e):1===s&&(i.firstMultiple=!1);var o=i.firstInput,r=i.firstMultiple,c=r?r.center:o.center,a=e.center=z(n);e.timeStamp=pe(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=k(c,a),e.distance=$(c,a),C(i,e),e.offsetDirection=N(e.deltaX,e.deltaY),e.scale=r?M(r.pointers,n):1,e.rotation=r?R(r.pointers,n):0,A(i,e);var l=t.element;f(e.srcEvent.target,l)&&(l=e.srcEvent.target),e.target=l}function C(t,e){var i=e.center,n=t.offsetDelta||{},s=t.prevDelta||{},o=t.prevInput||{};(e.eventType===Ee||o.eventType===Ie)&&(s=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=s.x+(i.x-n.x),e.deltaY=s.y+(i.y-n.y)}function A(t,e){var i,s,o,r,c=t.lastInterval||e,a=e.timeStamp-c.timeStamp;if(e.eventType!=Le&&(a>be||c.velocity===n)){var l=c.deltaX-e.deltaX,u=c.deltaY-e.deltaY,d=O(a,l,u);s=d.x,o=d.y,i=he(d.x)>he(d.y)?d.x:d.y,r=N(l,u),t.lastInterval=e}else i=c.velocity,s=c.velocityX,o=c.velocityY,r=c.direction;e.velocity=i,e.velocityX=s,e.velocityY=o,e.direction=r}function x(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:de(t.pointers[i].clientX),clientY:de(t.pointers[i].clientY)},i++;return{timeStamp:pe(),pointers:e,center:z(e),deltaX:t.deltaX,deltaY:t.deltaY}}function z(t){var e=t.length;if(1===e)return{x:de(t[0].clientX),y:de(t[0].clientY)};for(var i=0,n=0,s=0;e>s;)i+=t[s].clientX,n+=t[s].clientY,s++;return{x:de(i/e),y:de(n/e)}}function O(t,e,i){return{x:e/t||0,y:i/t||0}}function N(t,e){return t===e?Ce:he(t)>=he(e)?t>0?Ae:xe:e>0?ze:Oe}function $(t,e,i){i||(i=Re);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return Math.sqrt(n*n+s*s)}function k(t,e,i){i||(i=Re);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return 180*Math.atan2(s,n)/Math.PI}function R(t,e){return k(e[1],e[0],Me)-k(t[1],t[0],Me)}function M(t,e){return $(e[0],e[1],Me)/$(t[0],t[1],Me)}function P(){this.evEl=Fe,this.evWin=We,this.allow=!0,this.pressed=!1,E.apply(this,arguments)}function F(){this.evEl=Xe,this.evWin=qe,E.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function W(){this.evTarget=Ve,this.evWin=Ue,this.started=!1,E.apply(this,arguments)}function B(t,e){var i=_(t.touches),n=_(t.changedTouches);return e&(Ie|Le)&&(i=y(i.concat(n),"identifier",!0)),[i,n]}function Y(){this.evTarget=Ge,this.targetIds={},E.apply(this,arguments)}function X(t,e){var i=_(t.touches),n=this.targetIds;if(e&(Ee|Se)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var s,o,r=_(t.changedTouches),c=[],a=this.target;if(o=i.filter(function(t){return f(t.target,a)}),e===Ee)for(s=0;s<o.length;)n[o[s].identifier]=!0,s++;for(s=0;s<r.length;)n[r[s].identifier]&&c.push(r[s]),e&(Ie|Le)&&delete n[r[s].identifier],s++;return c.length?[y(o.concat(c),"identifier",!0),c]:void 0}function q(){E.apply(this,arguments);var t=u(this.handler,this);this.touch=new Y(this.manager,t),this.mouse=new P(this.manager,t)}function H(t,e){this.manager=t,this.set(e)}function V(t){if(v(t,ei))return ei;var e=v(t,ii),i=v(t,ni);return e&&i?ii+" "+ni:e||i?e?ii:ni:v(t,ti)?ti:Qe}function U(t){this.id=T(),this.manager=null,this.options=a(t||{},this.defaults),this.options.enable=h(this.options.enable,!0),this.state=si,this.simultaneous={},this.requireFail=[]}function j(t){return t&li?"cancel":t&ci?"end":t&ri?"move":t&oi?"start":""}function G(t){return t==Oe?"down":t==ze?"up":t==Ae?"left":t==xe?"right":""}function J(t,e){var i=e.manager;return i?i.get(t):t}function Z(){U.apply(this,arguments)}function K(){Z.apply(this,arguments),this.pX=null,this.pY=null}function Q(){Z.apply(this,arguments)}function te(){U.apply(this,arguments),this._timer=null,this._input=null}function ee(){Z.apply(this,arguments)}function ie(){Z.apply(this,arguments)}function ne(){U.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function se(t,e){return e=e||{},e.recognizers=h(e.recognizers,se.defaults.preset),new oe(t,e)}function oe(t,e){e=e||{},this.options=a(e,se.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=S(this),this.touchAction=new H(this,this.options.touchAction),re(this,!0),r(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function re(t,e){var i=t.element;r(t.options.cssProps,function(t,n){i.style[D(i.style,n)]=e?t:""})}function ce(t,i){var n=e.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var ae=["","webkit","moz","MS","ms","o"],le=e.createElement("div"),ue="function",de=Math.round,he=Math.abs,pe=Date.now,me=1,fe=/mobile|tablet|ip(ad|hone|od)|android/i,ve="ontouchstart"in t,ge=D(t,"PointerEvent")!==n,we=ve&&fe.test(navigator.userAgent),_e="touch",ye="pen",De="mouse",Te="kinect",be=25,Ee=1,Se=2,Ie=4,Le=8,Ce=1,Ae=2,xe=4,ze=8,Oe=16,Ne=Ae|xe,$e=ze|Oe,ke=Ne|$e,Re=["x","y"],Me=["clientX","clientY"];E.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(b(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(b(this.element),this.evWin,this.domHandler)}};var Pe={mousedown:Ee,mousemove:Se,mouseup:Ie},Fe="mousedown",We="mousemove mouseup";l(P,E,{handler:function(t){var e=Pe[t.type];e&Ee&&0===t.button&&(this.pressed=!0),e&Se&&1!==t.which&&(e=Ie),this.pressed&&this.allow&&(e&Ie&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:De,srcEvent:t}))}});var Be={pointerdown:Ee,pointermove:Se,pointerup:Ie,pointercancel:Le,pointerout:Le},Ye={2:_e,3:ye,4:De,5:Te},Xe="pointerdown",qe="pointermove pointerup pointercancel";t.MSPointerEvent&&(Xe="MSPointerDown",qe="MSPointerMove MSPointerUp MSPointerCancel"),l(F,E,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),s=Be[n],o=Ye[t.pointerType]||t.pointerType,r=o==_e,c=w(e,t.pointerId,"pointerId");s&Ee&&(0===t.button||r)?0>c&&(e.push(t),c=e.length-1):s&(Ie|Le)&&(i=!0),0>c||(e[c]=t,this.callback(this.manager,s,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),i&&e.splice(c,1))}});var He={touchstart:Ee,touchmove:Se,touchend:Ie,touchcancel:Le},Ve="touchstart",Ue="touchstart touchmove touchend touchcancel";l(W,E,{handler:function(t){var e=He[t.type];if(e===Ee&&(this.started=!0),this.started){var i=B.call(this,t,e);e&(Ie|Le)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:_e,srcEvent:t})}}});var je={touchstart:Ee,touchmove:Se,touchend:Ie,touchcancel:Le},Ge="touchstart touchmove touchend touchcancel";l(Y,E,{handler:function(t){var e=je[t.type],i=X.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:_e,srcEvent:t})}}),l(q,E,{handler:function(t,e,i){var n=i.pointerType==_e,s=i.pointerType==De;if(n)this.mouse.allow=!1;else if(s&&!this.mouse.allow)return;e&(Ie|Le)&&(this.mouse.allow=!0),this.callback(t,e,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Je=D(le.style,"touchAction"),Ze=Je!==n,Ke="compute",Qe="auto",ti="manipulation",ei="none",ii="pan-x",ni="pan-y";H.prototype={set:function(t){t==Ke&&(t=this.compute()),Ze&&(this.manager.element.style[Je]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return r(this.manager.recognizers,function(e){d(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),V(t.join(" "))},preventDefaults:function(t){if(!Ze){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var n=this.actions,s=v(n,ei),o=v(n,ni),r=v(n,ii);return s||o&&i&Ne||r&&i&$e?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var si=1,oi=2,ri=4,ci=8,ai=ci,li=16,ui=32;U.prototype={defaults:{},set:function(t){return c(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(o(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=J(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return o(t,"dropRecognizeWith",this)?this:(t=J(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(o(t,"requireFailure",this))return this;var e=this.requireFail;return t=J(t,this),-1===w(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(o(t,"dropRequireFailure",this))return this;t=J(t,this);var e=w(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(i.options.event+(e?j(n):""),t)}var i=this,n=this.state;ci>n&&e(!0),e(),n>=ci&&e(!0)},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=ui)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(ui|si)))return!1;t++}return!0},recognize:function(t){var e=c({},t);return d(this.options.enable,[this,e])?(this.state&(ai|li|ui)&&(this.state=si),this.state=this.process(e),void(this.state&(oi|ri|ci|li)&&this.tryEmit(e))):(this.reset(),void(this.state=ui))},process:function(){},getTouchAction:function(){},reset:function(){}},l(Z,U,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(oi|ri),s=this.attrTest(t);return n&&(i&Le||!s)?e|li:n||s?i&Ie?e|ci:e&oi?e|ri:oi:ui}}),l(K,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:ke},getTouchAction:function(){var t=this.options.direction,e=[];return t&Ne&&e.push(ni),t&$e&&e.push(ii),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,s=t.direction,o=t.deltaX,r=t.deltaY;return s&e.direction||(e.direction&Ne?(s=0===o?Ce:0>o?Ae:xe,i=o!=this.pX,n=Math.abs(t.deltaX)):(s=0===r?Ce:0>r?ze:Oe,i=r!=this.pY,n=Math.abs(t.deltaY))),t.direction=s,i&&n>e.threshold&&s&e.direction},attrTest:function(t){return Z.prototype.attrTest.call(this,t)&&(this.state&oi||!(this.state&oi)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=G(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),l(Q,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ei]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&oi)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),l(te,U,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Qe]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(Ie|Le)&&!o)this.reset();else if(t.eventType&Ee)this.reset(),this._timer=s(function(){this.state=ai,this.tryEmit()},e.time,this);else if(t.eventType&Ie)return ai;return ui},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ai&&(t&&t.eventType&Ie?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=pe(),this.manager.emit(this.options.event,this._input)))}}),l(ee,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ei]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&oi)}}),l(ie,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Ne|$e,pointers:1},getTouchAction:function(){return K.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(Ne|$e)?e=t.velocity:i&Ne?e=t.velocityX:i&$e&&(e=t.velocityY),this._super.attrTest.call(this,t)&&i&t.direction&&t.distance>this.options.threshold&&he(e)>this.options.velocity&&t.eventType&Ie},emit:function(t){var e=G(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),l(ne,U,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ti]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&Ee&&0===this.count)return this.failTimeout();if(n&&o&&i){if(t.eventType!=Ie)return this.failTimeout();var r=this.pTime?t.timeStamp-this.pTime<e.interval:!0,c=!this.pCenter||$(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,c&&r?this.count+=1:this.count=1,this._input=t;var a=this.count%e.taps;if(0===a)return this.hasRequireFailures()?(this._timer=s(function(){this.state=ai,this.tryEmit()},e.interval,this),oi):ai}return ui},failTimeout:function(){return this._timer=s(function(){this.state=ui},this.options.interval,this),ui},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ai&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),se.VERSION="2.0.4",se.defaults={domEvents:!1,touchAction:Ke,enable:!0,inputTarget:null,inputClass:null,preset:[[ee,{enable:!1}],[Q,{enable:!1},["rotate"]],[ie,{direction:Ne}],[K,{direction:Ne},["swipe"]],[ne],[ne,{event:"doubletap",taps:2},["tap"]],[te]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var di=1,hi=2;oe.prototype={set:function(t){return c(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?hi:di},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,s=e.curRecognizer;(!s||s&&s.state&ai)&&(s=e.curRecognizer=null);for(var o=0;o<n.length;)i=n[o],e.stopped===hi||s&&i!=s&&!i.canRecognizeWith(s)?i.reset():i.recognize(t),!s&&i.state&(oi|ri|ci)&&(s=e.curRecognizer=i),o++}},get:function(t){if(t instanceof U)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(o(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(o(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(w(e,t),1),this.touchAction.update(),this},on:function(t,e){var i=this.handlers;return r(g(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},off:function(t,e){var i=this.handlers;return r(g(t),function(t){e?i[t].splice(w(i[t],e),1):delete i[t]}),this},emit:function(t,e){this.options.domEvents&&ce(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&re(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(se,{INPUT_START:Ee,INPUT_MOVE:Se,INPUT_END:Ie,INPUT_CANCEL:Le,STATE_POSSIBLE:si,STATE_BEGAN:oi,STATE_CHANGED:ri,STATE_ENDED:ci,STATE_RECOGNIZED:ai,STATE_CANCELLED:li,STATE_FAILED:ui,DIRECTION_NONE:Ce,DIRECTION_LEFT:Ae,DIRECTION_RIGHT:xe,DIRECTION_UP:ze,DIRECTION_DOWN:Oe,DIRECTION_HORIZONTAL:Ne,DIRECTION_VERTICAL:$e,DIRECTION_ALL:ke,Manager:oe,Input:E,TouchAction:H,TouchInput:Y,MouseInput:P,PointerEventInput:F,TouchMouseInput:q,SingleTouchInput:W,Recognizer:U,AttrRecognizer:Z,Tap:ne,Pan:K,Swipe:ie,Pinch:Q,Rotate:ee,Press:te,on:p,off:m,each:r,merge:a,extend:c,inherit:l,bindFn:u,prefixed:D}),typeof define==ue&&define.amd?define("rsp/hammer",[],function(){return se}):"undefined"!=typeof module&&module.exports?module.exports=se:t[i]=se}(window,document,"Hammer"),define("rsp/views/documentWidget",["jquery","underscore","rsp/hammer","dcpDocument/document","backbone"],function(t,e,i){return Backbone.View.extend({className:"documentsWrapper__div",initialize:function(){this.listenTo(this.model,"change:selected",this.indicateSelected),this.listenTo(this.model,"change:title",this.indicateSelected),this.listenTo(this.model,"change",this.setFrameName),this.listenTo(this.model,"destroy",this.delete),t(window).on("resize",e.debounce(e.bind(this._resize,this),100))},render:function(){var i=this,n=e.bind(this.indicateSelected,this);return this.$el.document("fetchDocument",{initid:this.model.id,viewId:this.model.get("viewId"),withoutResize:!0}),this.$el.document("addEvent","ready",function(e,s){i.model.set(s),i.model.set("attributes",this.documentController("getValues")),s.name&&"VOID_DOCUMENT"===s.name||i.model.trigger("reloadDocument",i.model.toJSON()),t(this).find("header").hide(),n()}),this.$el.document("addEvent","beforeClose",function(t,e,n){var s=i.model.collection.get(n.initid);return parseInt(n.initid,10)===parseInt(i.model.get("initid"),10)?void s.trigger("selected",s):(t.preventDefault(),void(s?s.trigger("selected",s):i.model.collection.add({initid:n.initid,title:"Chargement"})))}),this.$el.document("addEvent","afterSave",function(t,e,n){0===n.id&&i.model.trigger("reloadDocumentList")}),this.$el.document("addEvent","afterDelete",function(t,e){i.model.trigger("removeDocument",e)}),this.setFrameName(),this.setSwipeEvent(),this},indicateSelected:function(){this.model.get("selected")?(this.$el.show(),window.document.title=this.model.get("title"),window.documentSelected=this.$el,this._resize()):this.$el.hide()},_resize:function(){var i=this,n=function(t){return t=t[0],t.getBoundingClientRect().top+5};this.$el.is(":visible")&&(this.$el.find("iframe").height(t(window).innerHeight()-n(this.$el)).width(this.$el.innerWidth()-1),e.defer(function(){i.$el.find("iframe").height(t(window).innerHeight()-n(i.$el))},50))},"delete":function(){this.$el.remove()},setFrameName:function(){var t="document_"+this.model.get("initid")+"_"+this.model.get("title");this.$el.find("iframe").attr("name",t)},setSwipeEvent:function(){var t=this.$el.find("iframe"),n=this,s=e.bind(function(){var t=this.contentWindow.document.body;t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.right=0,t.style.bottom=0,i(t).on("swipeleft",function(){n.model.collection.trigger("selectNext",n.model)}),i(t).on("swiperight",function(){n.model.collection.trigger("selectPrevious",n.model)})},t[0]);t.on("load",s),s()}})}),define("rsp/views/openDocument",["jquery","underscore","rsp/views/openDocumentListElement","rsp/views/documentWidget","backbone","bootstrap"],function(t,e,i,n){var s={global:e.template('<ul class="nav nav-tabs documentList">   <li class="openDocuments__openDocumentCloseAll pull-right" title="Fermer tous les documents">       <button type="button" class="btn btn-link">            <span class="fa fa-times-circle-o"></span>       </button>   </li>   <li class="openDocuments__more pull-right" style="visibility: hidden;">       <div class="btn-group" title="Plus de documents">           <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">               <span class="fa fa-bars"></span>               +<span class="openDocuments__more__number"></span> <span class="caret"></span>           </button>           <ul class="dropdown-menu pull-right openDocuments__more__documents" role="menu">           </ul>       </div>   </li>   <li class="openDocuments__openDocumentList visible-xs visible-sm">       <button type="button" class="btn btn-link">           <span class="fa fa-2x fa-bars"></span>       </button>   </li>   <li class="openDocuments__createDocument">       <div class="btn-group" title="Créer un document">           <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-expanded="false">               <span class="glyphicon glyphicon-plus-sign"></span>               Nouveau <span class="caret"></span>           </button>           <ul class="dropdown-menu openDocuments__createDocument__families" role="menu">           </ul>       </div>   </li></ul><div class="documentsWrapper"></div>'),families:e.template('<% _.each(families, function(currentFamily) { %>   <li>       <a class="openDocuments__createDocument__familyElement" href="#<%- currentFamily.initid %>" data-initid="<%- currentFamily.initid %>">          <img src="<%- currentFamily.icon %>" class="img-circle documentElement__icon"><%- currentFamily.title %>      </a>    </li> <% }); %>')};return Backbone.View.extend({events:{"click .openDocuments__openDocumentList":"switchSide","click .openDocuments__createDocument__familyElement":"openCreation","click .openDocuments__openDocumentCloseAll":"closeAll"},initialize:function(i){if(!i.openDocuments)throw new Error("You need an openDocuments collection");this.openDocuments=i.openDocuments,this.listenTo(this.openDocuments,"add",this._addDocument),this.listenTo(this.openDocuments,"selected",this.openDocumentIHM),this.listenTo(this.openDocuments,"orderChanged",this.renderOpenDocument),this.listenTo(this.openDocuments,"destroy",this.renderOpenDocument),this.nbMaxOpen=0,this.isReady=!1,t(window).on("resize",e.debounce(e.bind(this._resize,this),200))},render:function(){return this.$el.append(s.global()),0===window.dcp.creatable_family.length?this.$el.find(".openDocuments__createDocument").remove():this.$el.find(".openDocuments__createDocument__families").append(s.families({families:window.dcp.creatable_family})),this.isReady=!0,this.addPreload(),this},addPreload:function(){var e=t('<div class="documentPreload" style="display : none;"></div>');this.$el.find(".documentsWrapper").append(e),e.document({initid:"VOID_DOCUMENT"})},switchSide:function(){this.trigger("switchSide")},openDocumentIHM:function(){this.trigger("openDocumentIHM")},openCreation:function(e){var i=t(e.currentTarget);e.preventDefault(),this.openDocuments.add({initid:i.data("initid"),viewId:"!coreCreation"})},_addDocument:function(t){var e,i;this.renderOpenDocument(),e=this.$el.find(".documentPreload"),e.removeClass("documentPreload"),i=new n({model:t,el:e}),i.render(),t.trigger("selected",t),this.addPreload(),i._resize()},renderOpenDocument:function(){var t=0,n=this.nbMaxOpen,s=this.$el.find(".documentList"),o=this.$(".openDocuments__more__documents");s.find(".openDocuments__tab").remove(),o.empty(),e.each(this.openDocuments.sortBy(function(t){return-t.get("dateSelected")}),function(e){var r=new i({model:e});n>t?s.append(r.render().$el):o.append(r.render({hidden:!0}).$el),t+=1}),0!==t&&t>n?(this.$(".openDocuments__more").css("visibility","visible"),this.$(".openDocuments__more__number").text(t-n)):this.$(".openDocuments__more").css("visibility","hidden")},closeAll:function(){for(var t;t=this.openDocuments.first();)t.destroy()},_resize:function(){var t=this.nbMaxOpen;this.isReady&&(this.nbMaxOpen=Math.floor((this._getBorder(this.$el.find(".openDocuments__more"),"left")-this._getBorder(this.$el.find(".openDocuments__createDocument"),"right")-10)/202),t!==this.nbMaxOpen&&this.renderOpenDocument())},_getBorder:function(t,e){return t=t[0],t.getBoundingClientRect()[e]}})}),require(["jquery","underscore","rsp/collections/search","rsp/collections/openDocument","rsp/views/searches","rsp/views/documentList","rsp/views/openDocument","dcpDocument/document"],function(t,e,i,n,s,o,r){var c=function(){t(".documentsList").toggleClass("hiddenLittle"),t(".openDocuments").toggleClass("hiddenLittle"),t(window).trigger("resize")};return window.dcp.search_list&&0!==window.dcp.search_list.length?(window.dcp=window.dcp||{},window.dcp.collections=window.dcp.collections||{},window.dcp.views=window.dcp.views||{},window.dcp.collections.searches=new i,window.dcp.collections.openDocuments=new n,void t(document).ready(function(){window.dcp.views.searches=new s({el:t(".documentsList__searchList"),collection:window.dcp.collections.searches}),window.dcp.views.searches.render(),window.dcp.views.documentList=new o({el:t(".documentsList__documents"),collection:window.dcp.collections.searches,openDocuments:window.dcp.collections.openDocuments}),window.dcp.views.openDocument=new r({el:t(".openDocuments"),openDocuments:window.dcp.collections.openDocuments}),window.dcp.views.openDocument.listenTo(window.dcp.views.openDocument,"switchSide",function(){c()
}),window.dcp.views.openDocument.listenTo(window.dcp.views.openDocument,"openDocumentIHM",function(){t(".documentsList").addClass("hiddenLittle"),t(".openDocuments").removeClass("hiddenLittle"),t(window).trigger("resize")}),window.dcp.collections.openDocuments.listenTo(window.dcp.collections.openDocuments,"reloadDocumentList",function(){window.dcp.views.documentList.trigger("reloadDocumentList")}),window.dcp.collections.openDocuments.listenTo(window.dcp.collections.openDocuments,"reloadDocument",function(t){window.dcp.views.documentList.trigger("reloadDocument",t)}),window.dcp.collections.openDocuments.listenTo(window.dcp.collections.openDocuments,"removeDocument",function(t){window.dcp.views.documentList.trigger("removeDocument",t)}),t(".documentList__switch").on("click",function(){c()}),t(".unlog--button").on("click",function(){t("#disconnect").submit()}),window.dcp.views.openDocument.render(),window.dcp.views.documentList.render(),window.dcp.collections.searches.add(window.dcp.search_list),window.dcp.views.searches.displayDocumentList(),t(".loading--initial").hide(),t(".content").show(),t(window).trigger("resize")})):(t(".loading--initial").hide(),void t(".error__wrapper").show())}),define("RESPONSIVE_LIST/JS/main",function(){});
//# sourceMappingURL=main-built.js.map